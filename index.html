<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Apocalypse</title>

    <link href="css/flip.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

</head>
<body>

<h1 class="hero-heading">
    <span class="text-wrapper"></span>
</h1>

<div class="tick" data-did-init="handleTickInit" data-credits="false">

    <div data-repeat="true" data-layout="horizontal fit" data-transform="preset(y, M, d, h, m, s) -> delay">

        <div class="tick-group">

            <div data-key="value" data-repeat="true" data-transform="pad(00) -> split -> delay">

                <span data-view="flip"></span>

            </div>

            <span data-key="label" data-view="text" class="tick-label"></span>

        </div>

    </div>

</div>

<!-- Anime.js -->
<script src="js/anime.min.js"></script>

<!-- Tick/Flip JavaScript -->
<script src="js/flip.min.js"></script>

<script>
    // Typing animation
    var textWrapper = document.querySelector('.text-wrapper');
    var text = 'Time Since Last AWS Apocalypse';

    // Wrap every letter in a span, preserving spaces
    var wrappedText = '';
    var apocalypseStart = text.indexOf('Apocalypse');
    var apocalypseEnd = apocalypseStart + 11;

    for (var i = 0; i < text.length; i++) {
        // Start apocalypse wrapper
        if (i === apocalypseStart) {
            wrappedText += '<span class="apocalypse-wrapper">';
        }

        if (text[i] === ' ') {
            wrappedText += "<span class='letter'>&nbsp;</span>";
        } else {
            wrappedText += "<span class='letter'>" + text[i] + "</span>";
        }

        // End apocalypse wrapper
        if (i === apocalypseEnd - 1) {
            wrappedText += '</span>';
        }
    }
    textWrapper.innerHTML = wrappedText;

    var letters = document.querySelectorAll('.hero-heading .letter');
    var apocalypseWrapper = document.querySelector('.apocalypse-wrapper');

    // Set initial styles to prevent layout shift
    apocalypseWrapper.style.display = 'inline-block';
    apocalypseWrapper.style.borderBottom = '3px solid transparent';

    // Animate letters one by one
    var currentIndex = 0;

    function typeNextLetter() {
        if (currentIndex < letters.length) {
            // Show current letter
            letters[currentIndex].style.opacity = '1';

            currentIndex++;
            setTimeout(typeNextLetter, 25);
        } else {
            // Typing complete, wait before changing color
            setTimeout(function() {
                // Animate color and underline
                anime({
                    targets: apocalypseWrapper,
                    color: '#dc3545',
                    borderBottom: '3px solid rgba(220, 53, 69, 1)',
                    duration: 500,
                    easing: 'easeInOutQuad',
                    complete: function() {
                        // Fade in counter
                        setTimeout(function() {
                            anime({
                                targets: '.tick',
                                opacity: [0, 1],
                                duration: 1000,
                                easing: 'easeInOutQuad'
                            });
                        }, 250);
                    }
                });
            }, 300);  // 300ms delay before changing color
        }
    }

    // Start typing
    typeNextLetter();

    function handleTickInit(tick) {
        var locale = {
            YEAR_PLURAL: 'Years',
            YEAR_SINGULAR: 'Year',
            MONTH_PLURAL: 'Months',
            MONTH_SINGULAR: 'Month',
            WEEK_PLURAL: 'Weeks',
            WEEK_SINGULAR: 'Week',
            DAY_PLURAL: 'Days',
            DAY_SINGULAR: 'Day',
            HOUR_PLURAL: 'Hours',
            HOUR_SINGULAR: 'Hour',
            MINUTE_PLURAL: 'Minutes',
            MINUTE_SINGULAR: 'Minute',
            SECOND_PLURAL: 'Seconds',
            SECOND_SINGULAR: 'Second',
        };

        for (var key in locale) {
            if (!locale.hasOwnProperty(key)) { continue; }
            tick.setConstant(key, locale[key]);
        }

        // create counter
        Tick.count.up('2025-10-20T06:49:00Z', { format: ['y','M','d','h','m','s'] }).onupdate = function (value) {
            tick.value = value;
        };

    }
</script>

</body>
</html>
